# -*- coding: utf-8 -*-
"""SLR Tip prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1G6Ed6a2Do-Xu7cg3sSi_CxP6oaKUgg4f
"""

import numpy as np
import matplotlib.pyplot as plt
plt.rcParams['figure.figsize'] = (8.0, 5.0)

X = np.array([34, 108, 64, 88, 99, 51])
Y = np.array([5, 17, 11, 8, 14, 5])


plt.scatter(X,Y)
plt.show()

theta1_list=[]
theta0_list=[]
cost_list=[]

theta1=0
theta0=0

L=0.00001
epohcs = 800000
Y_pred = theta0 + theta1*X

m = float(len(X))
iteration = []
#performing gradient descent
print('theta0\t, theta1\t, cost', 'Epoch')
for i in range(epohcs):
    if i<10:
        Y_pred = theta0 + theta1*X
        temp0 = (2/m)*sum(Y_pred-Y)
        temp1 = (2/m)*sum(X*(Y_pred-Y))

        theta0 = theta0 - L*temp0
        theta1 = theta1 - L*temp1

        theta0_list.append(theta0)
        theta1_list.append(theta1)

        Y_pred = theta0 + theta1*X

        cost = np.sum((Y_pred - Y)**2)
        cost_list.append(cost)
        print(theta0,'\t',theta1,'\t', cost)
        plt.scatter(X,Y)
        plt.plot([min(X),max(X)],[min(Y_pred), max(Y_pred)], color = 'red')
        plt.show()
        iteration.append(i)
    Y_pred = theta0 + theta1*X
    temp0 = (2/m)*sum(Y_pred-Y)
    temp1 = (2/m)*sum(X*(Y_pred-Y))

    theta0 = theta0 - L*temp0
    theta1 = theta1 - L*temp1

    theta0_list.append(theta0)
    theta1_list.append(theta1)

    Y_pred = theta0 + theta1*X

    cost = np.sum((Y_pred - Y)**2)
    cost_list.append(cost)
    iteration.append(i)

print(theta0, '\t', theta1, '\t', cost)
plt.scatter(X,Y)
plt.plot([min(X),max(X)],[min(Y_pred), max(Y_pred)], color = 'red')

Y_pred = theta0 + theta1*X

print('Linear Regression Equation: Y_pred = ', theta0, '+', theta1,'X')

cost = np.sum((Y_pred-Y)**2)
cost_list.append(cost)
Y_mean = np.mean(Y)
SST = np.sum((Y_mean - Y)**2)
SSR = SST - cost
R_Square = (SSR/SST)*100
print('\nSST= ', SST,'\nSSR= ', SSR, '\nSSE= ', cost, '\nR_Square= ', R_Square)



